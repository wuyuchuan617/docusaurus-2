---
sidebar_position: 4
sidebar_label: Week 1
tags:
  - Blockchain
  - Ethereum
---

import Admonition from "@theme/Admonition";

# Week 1

æŒæ¡åŸºæœ¬å€å¡Šéˆæ¦‚å¿µï¼Œäº†è§£ Ethereum åº•å±¤åŸç†

## Questions

---

#### Homework

1. æŒ–ç¤¦çš„åŸç†ç‚ºä½•ï¼Ÿç¤¦å·¥å¦‚ä½•æ”¶é›†å¾…æŒ–çš„äº¤æ˜“è³‡æ–™ï¼Ÿï¼ˆä»¥ PoW å›ç­”ï¼‰[Ans 1](#hw1-1) , [Ans 2](#hw1-2)
2. è«‹æè¿°ä½•è¬‚ Transaction? ä»€éº¼æ˜¯äº¤æ˜“ç¢ºèªæ¬¡æ•¸ï¼ŸTransaction Hash å¦‚ä½•ç”¢ç”Ÿï¼Ÿ[Ans 1](#hw2-1) , [Ans 2](#hw2-2) , [Ans 3](#hw2-3)
3. å€å¡Šçš„ Nonce èˆ‡ Ethereum äº¤æ˜“çš„ Nonce åˆ†åˆ¥æ˜¯ä»€éº¼æ„æ€ï¼Ÿè§£æ±ºä»€éº¼å•é¡Œï¼Ÿ[Ans](#hw3)
4. åŠ å¯†éŒ¢åŒ…çš„åœ°å€ã€å…¬é‘°ã€ç§é‘°é—œä¿‚ç‚ºä½•ï¼ŸéŒ¢åŒ…å¦‚ä½•é€éå…¬ç§é‘°é€²è¡Œç°½ç« èˆ‡é©—è­‰ï¼Ÿ [Ans 1](#hw4-1) , [Ans 2](#hw4-2)
5. ETH è½‰æˆ POSï¼Œèˆ‡ PoW æœ‰å“ªäº›å·®ç•°ï¼Ÿæƒ³è¦è§£æ±ºä»€éº¼å•é¡Œï¼Ÿ [Ans 1](#hw5-1) , [Ans 2](#hw5-2)

#### Class

1. å€å¡Šéˆçš„å‡ºç¾ï¼Œæœ€åˆæ˜¯ç‚ºäº†è§£æ±ºä»€éº¼å•é¡Œï¼Ÿ
2. ä½•è¬‚ã€Œä¸å¯ç¯¡æ”¹ã€ï¼Ÿä¸Šéˆçš„æ•¸æ“šè·Ÿåˆç´„/ç¨‹å¼ç¢¼ã€ç™¼ç”Ÿéçš„äº¤æ˜“çœŸçš„ä¸èƒ½æ›´æ”¹å—ï¼Ÿ
3. ä½ è½éå“ªäº›å…±è­˜æ©Ÿåˆ¶ï¼Ÿè«‹èˆ‰å‡º 2 ç¨®
4. è¨è«–é€™ 2 ç¨®å…±è­˜æ©Ÿåˆ¶å¦‚ä½•ç¬¦åˆã€Œå»ä¸­å¿ƒåŒ–ã€çš„åŸå‰‡ï¼Ÿ

#### Test

1. è«‹èªªæ˜ç›®å‰ Ethereum gas æ¶ˆè€—å¦‚ä½•è¨ˆç®—ï¼Ÿ
2. è«‹å•åˆç´„ä¸Šéˆä»¥å¾Œï¼Œé‹ç®—é‚è¼¯è·Ÿè®Šæ•¸æ•¸å€¼é‚„èƒ½ä¿®æ”¹å—ï¼Ÿ
3. ä»€éº¼æ˜¯ AMM (Auto-Market Makerï¼Œè‡ªå‹•åŒ–åšå¸‚å•†)ï¼Ÿ

## Consensus Mechanism

---

å…±è­˜æ©Ÿåˆ¶ï¼ˆConsensus Mechanismï¼‰æ˜¯ä¸€ç¨®åœ¨å€å¡Šéˆç¶²çµ¡ä¸­é”æˆä¸€è‡´æ€§çš„æ–¹æ³•ã€‚å› ç‚ºåœ¨å€å¡Šéˆä¸­æ˜¯å»ä¸­å¿ƒåŒ–çš„ï¼Œä¸æ˜¯æœ‰ä¸€å€‹æ©Ÿæ§‹æ±ºå®šé”æˆå…±è­˜ï¼Œå› æ­¤åœ¨å€å¡Šéˆä¸­ç™¼å±•å‡ºå¾ˆå¤šä¸åŒçš„å…±è­˜æ©Ÿåˆ¶åˆ¶åº¦ï¼Œä½œæ³•ä¸åŒä½†éƒ½æ˜¯ç‚ºäº†é”æˆå…±è­˜ã€ä¿è­·å€å¡Šéˆç¶²è·¯çš„å®‰å…¨ã€‚ä»¥ä¸‹èªªæ˜ POWã€POS å…©ç¨®å…±è­˜æ©Ÿåˆ¶åŠæ¯”è¼ƒã€‚å¦å¤–ä¹Ÿæœƒèªªæ˜ç‚ºä»€éº¼ Ethereum å¾ 2022 å¹´å¾ PoW è½‰ç‚º POSã€‚

### Proof-Of-Work (PoW)

> **Proof-Of-Work æ˜¯ä»€éº¼ï¼Ÿ**

åœ¨ PoW ï¼ˆå·¥ä½œé‡è­‰æ˜ï¼‰å…±è­˜æ©Ÿåˆ¶ä¸­ï¼Œç¤¦å·¥æœƒåˆ©ç”¨é›»è…¦é‹ç®—èƒ½åŠ›æ‰¾å‡º Nonceï¼Œç¬¬ä¸€å€‹æ‰¾å‡º nonce çš„ç¤¦å·¥æœ‰æ¬Šåˆ©å»ºç«‹å¿ƒçš„å€å¡Šåˆ°å€å¡Šéˆä¸­ä¸¦å¾—åˆ°çå‹µã€‚

> **Proof-Of-Work Nonce æ˜¯ä»€éº¼ï¼Ÿ**

PoW æ‰€è§£çš„å•é¡Œæ˜¯ä¸€å€‹ Hash å•é¡Œï¼Œäº¤æ˜“å…§å®¹èˆ‡é€™å€‹ Nonce éš¨æ„æ•¸é€²è¡Œ hash é‹ç®—å¾Œï¼Œç”¢ç”Ÿçš„ hash å€¼æ»¿è¶³æŸå€‹æ¢ä»¶ã€‚é€šå¸¸é€™å€‹æ¢ä»¶æ˜¯ï¼šç”¢ç”Ÿçš„ Hash å€¼å¿…é ˆå°æ–¼æˆ–ç­‰æ–¼ä¸€å€‹ç›®æ¨™å€¼ï¼Œæˆ–è€… hash å€¼çš„å‰ n ä½å¿…é ˆç‚ºé›¶ã€‚

èˆ‰ä¾‹ï¼Œç›®æ¨™æ˜¯æ‰¾åˆ°ä¸€å€‹ Nonceï¼Œè©² Nonce èˆ‡äº¤æ˜“ç¶“é SHA-256 hash ç®—ï¼Œç”¢ç”Ÿçš„å“ˆå¸Œå€¼çš„å‰ 4 ä½ç‚ºé›¶ã€‚ç¤¦å·¥æœƒä¸æ–·åœ°å˜—è©¦ä¸åŒçš„ Nonce å€¼ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€å€‹ hash å€¼æ»¿è¶³é€™å€‹æ¢ä»¶çš„ Nonceã€‚

ç”±æ–¼å“ˆå¸Œå‡½æ•¸æ˜¯ä¸å¯é æ¸¬çš„ï¼Œå› æ­¤é€šå¸¸éœ€è¦å˜—è©¦å¤§é‡çš„ Nonce å€¼æ‰èƒ½æ‰¾åˆ°ä¸€å€‹æœ‰æ•ˆçš„è§£ã€‚ä¸€æ—¦æ‰¾åˆ°é€™æ¨£ä¸€å€‹ Nonceï¼Œé€™å€‹å€å¡Šå°±æœƒè¢«æ·»åŠ åˆ°å€å¡Šéˆä¸Šï¼Œä¸¦ä¸”ç¤¦å·¥æœƒç²å¾—ç›¸æ‡‰çš„çå‹µã€‚

> **Proof-Of-Work Nonce è§£æ±ºä»€éº¼å•é¡Œï¼Ÿ**

ç‚ºäº†é˜²æ­¢ç¶²çµ¡é­å—å„ç¨®å®‰å…¨æ”»æ“Šï¼Œå¦‚é›™é‡æ”¯ä»˜ï¼ˆDouble-Spendingï¼‰å’Œ 51%æ”»æ“Šã€‚ç¢ºä¿ç¶²çµ¡çš„å®‰å…¨æ€§ã€ä¸å¯è¢«ç¯¡æ”¹å’Œå»ä¸­å¿ƒåŒ–ï¼Œä¸¦é”æˆç¶²çµ¡å…±è­˜ã€‚POW é€šéç¤¦å·¥è¨ˆç®— nonce ä¾†å‰µå»ºæ–°å€å¡Šï¼Œä½¿å¾—åŸ·è¡Œé€™äº›æ”»æ“Šè¡Œç‚ºéœ€è¦å¤§é‡çš„è¨ˆç®—è³‡æºå’Œæˆæœ¬ï¼Œå› æ­¤å¤§å¤§æé«˜äº†æ”»æ“Šçš„é›£åº¦ã€‚

> **ä»€éº¼æ˜¯ Double-Spendingï¼Ÿ**

é›™é‡æ”¯ä»˜ï¼ˆDouble-Spendingï¼‰æ˜¯ä¸€ç¨®æ”»æ“Šï¼Œå…¶ä¸­ä¸€å€‹ç”¨æˆ¶è©¦åœ–åŒæ™‚èŠ±è²»åŒä¸€ç­†è³‡é‡‘å…©æ¬¡æˆ–æ›´å¤šæ¬¡ã€‚èˆ‰ä¾‹ï¼šå‡è¨­ Alice æœ‰ 10 ETHã€‚å¥¹åŒæ™‚å‘ Bob å’Œ Charlie ç™¼é€ 10 ETHã€‚å¦‚æœç³»çµ±ä¸èƒ½é˜²æ­¢é›™é‡æ”¯ä»˜ï¼Œé‚£éº¼ Alice å°±å¯èƒ½æˆåŠŸåœ°å°‡åŒä¸€ç­†è³‡é‡‘èŠ±è²»äº†å…©æ¬¡ã€‚

> **ä»€éº¼æ˜¯ 51%æ”»æ“Šï¼Ÿ**

åœ¨ PoW æˆ– PoS çš„å€å¡Šéˆä¸­ï¼Œå¦‚æœä¸€å€‹ç¤¦å·¥æŒæ¡äº†è¶…é 50%çš„ç®—åŠ›ï¼Œä»–å€‘å°±æœ‰å¯èƒ½æ§åˆ¶ç¶²çµ¡ä¸¦å½±éŸ¿å…±è­˜æ©Ÿåˆ¶ã€‚

### Mining

> #### ç¤¦å·¥å¦‚ä½•æ”¶é›†å¾…æŒ–çš„äº¤æ˜“è³‡æ–™ï¼Ÿ{#hw1-2}

ç¤¦å·¥å¾äº¤æ˜“æ± ï¼ˆæˆ–ç¨±ç‚ºè¨˜æ†¶é«”æ± ã€mempoolï¼‰ä¸­æ”¶é›†å¾…æŒ–çš„äº¤æ˜“è³‡æ–™ã€‚

> #### æŒ–ç¤¦çš„æµç¨‹ {#hw1-1}

æŒ–ç¤¦æ˜¯ä¸€å€‹åœ¨åœ¨ Proof-Of-Work (PoW) å…±è­˜æ©Ÿåˆ¶ä¸­ï¼Œç”¢ç”Ÿå€å¡Šã€é©—è­‰å€å¡Šã€ä¸¦å°‡å€å¡Šå¯«å…¥å€å¡Šéˆçš„éç¨‹ï¼Œä¸¦ç¢ºä¿æ•´å€‹ç¶²è·¯çš„å®‰å…¨æ€§é¿å…é­å—æ”»æ“Šã€‚

1. å‰µå»ºäº¤æ˜“ï¼Œä½¿ç”¨ç§é‘°å°äº¤æ˜“ç°½ç« 

   - æœ‰ä¸€ç­†äº¤æ˜“ tx
   - å°‡ tx é€²è¡Œ RLPï¼ˆRecursive Length Prefixï¼‰ç·¨ç¢¼å¯ä»¥å¾—åˆ° Signing Data
   - ç”¨ keccak256 å° Signing Data é€²è¡Œ Hash å¾—åˆ° Signing Hash
   - ç”¨ Private Key å° Signing Hash é€²è¡Œ secp256k1 ç°½ç« ç”¢ç”Ÿ Signature (v, r, s)
   - å°‡åŸå§‹äº¤æ˜“ tx + Signature (v, r, s) ä¸€èµ·åš RLP ç·¨ç¢¼ç”¢ç”Ÿ Signed Transaction = rawTransaction = Transaction Hash

2. å»£æ’­äº¤æ˜“
   - ç”±æŸå€‹ç¯€é»å°é™„è¿‘çš„ç¯€é»å»£æ’­ï¼Œé„°è¿‘ç¯€é»å†å°é„°è¿‘ç¯€é»å»£æ’­ï¼Œç›´åˆ°æ•´å€‹ç¶²è·¯çš„ç¯€é»éƒ½æ”¶åˆ°é€™ç­†äº¤æ˜“è«‹æ±‚ã€‚
3. äº¤æ˜“æ± å’ŒåŸºæœ¬é©—è­‰
   - ç•¶ç¯€é»æ¥æ”¶åˆ°æ–°çš„äº¤æ˜“è«‹æ±‚æ™‚ï¼Œæœƒå°‡è©²ç­†äº¤æ˜“æ”¾å…¥ local mempool (è£¡é¢éƒ½æ”¾å°šæœªè¢« committed to å€å¡Šéˆçš„äº¤æ˜“)
   - å»åšåŸºæœ¬é©—è­‰é€™ç­†äº¤æ˜“æ˜¯å¦åˆæ³•ï¼Œä¾‹å¦‚æª¢æŸ¥äº¤æ˜“çš„ç°½åæ˜¯å¦æ­£ç¢ºï¼Œæ˜¯å¦æœ‰è¶³å¤ çš„è³‡é‡‘ç­‰ã€‚
4. é©—è­‰ã€åŸ·è¡Œ

   - æŒ–ç¤¦ç¯€é»å¾ local mempool ä¸­ï¼Œå„ªå…ˆæŒ‘é¸ Fee è¼ƒé«˜çš„äº¤æ˜“ï¼Œå°‡å¤šç­†æ”¾åˆ° potential block ä¸­å¾Œæœƒåšå…©ä»¶äº‹æƒ…ï¼ŒVerefyã€ Execute(åŸ·è¡Œäº¤æ˜“æˆ–æ™ºèƒ½åˆç´„)ã€‚
   - Verifyï¼šå°‡å…¶å…§éƒ¨çš„ç¨‹å¼ç¢¼é€²è¡ŒåŸ·è¡Œï¼ˆå¦‚æœæœ‰çš„è©±ï¼‰ä¸¦æ ¹æ“šçµæœä¿®æ”¹å€å¡Šä¸­çš„ç‹€æ…‹ï¼ˆStateï¼‰ã€‚é€™éƒ¨åˆ†é‚„åœç•™åœ¨ä»–å€‘ Local å»ºç«‹çš„å€å¡Šï¼Œä¸æ˜¯æœ€å¾Œæ•´å€‹çš„ä»¥å¤ªåŠç¶²è·¯çš„ç‹€æ…‹ã€‚
   - Executeï¼šç•¶å€å¡Šå…§éƒ¨çš„äº¤æ˜“èˆ‡ç¨‹å¼ç¢¼éƒ½è¢«å¾¹åº•åŸ·è¡Œä¹‹å¾Œï¼Œç¤¦å·¥å¯ä»¥é–‹å§‹é€²è¡Œ PoW çš„å·¥ä½œï¼Œçˆ­å–å°‡é€™å€‹å€å¡Šæ¨ä¸Šä¸»ç¶²çš„æ©Ÿæœƒã€‚

5. æŒ–ç¤¦

   - ä¸€æ—¦æ‰€æœ‰äº¤æ˜“éƒ½è¢«é©—è­‰å’ŒåŸ·è¡Œï¼ŒæŒ–ç¤¦ç¯€é»æœƒé–‹å§‹é€²è¡Œ PoW æŒ–ç¤¦éç¨‹ï¼Œè©¦åœ–æ‰¾åˆ°ä¸€å€‹æœ‰æ•ˆçš„ nonceã€‚
   - ç¤¦å·¥å¾ä¸€å€‹åˆå§‹å€¼ï¼ˆé€šå¸¸æ˜¯ 0 æˆ–ä¸€å€‹éš¨æ©Ÿæ•¸å­—ï¼‰é–‹å§‹ã€‚
   - ç¤¦å·¥å°‡é€™å€‹ Nonce èˆ‡å€å¡Šçš„å…¶ä»–æ•¸æ“šçµ„åˆåœ¨ä¸€èµ·ã€‚
   - ä½¿ç”¨ Hash å‡½æ•¸ï¼ˆä¾‹å¦‚ï¼ŒSHA-256 æ–¼æ¯”ç‰¹å¹£ä¸­ï¼‰å°çµ„åˆå¾Œçš„æ•¸æ“šé€²è¡Œå“ˆå¸Œé‹ç®—ã€‚
   - æª¢æª¢æŸ¥è¨ˆç®—å‡ºçš„å“ˆå¸Œå€¼æ˜¯å¦æ»¿è¶³æŸå€‹ç‰¹å®šæ¢ä»¶ã€‚å¦‚æœå“ˆå¸Œå€¼æ»¿è¶³æ¢ä»¶ï¼Œå‰‡æ‰¾åˆ°äº†åˆé©çš„ Nonceï¼Œä¸¦å°‡å…¶èˆ‡å€å¡Šæ•¸æ“šä¸€èµ·å»£æ’­åˆ°ç¶²çµ¡ï¼Œè©²å€å¡Šæœƒè¢«å…¶ä»–ç¯€é»é©—è­‰ä¸¦æ·»åŠ åˆ°å€å¡Šéˆä¸Šã€‚å¦‚æœå“ˆå¸Œå€¼ä¸æ»¿è¶³æ¢ä»¶ï¼Œå‰‡éœ€è¦æ”¹è®Š Nonceï¼ˆé€šå¸¸æ˜¯å¢åŠ  1 æˆ–ä½¿ç”¨å…¶ä»–æ–¹å¼é€²è¡Œè®Šæ›´ï¼‰ä¸¦é‡è¤‡æ­¥é©Ÿã€‚

Source :

- [Anders Brownworth Blockchain 101 å½±ç‰‡](https://www.youtube.com/watch?v=_160oMzblY8)
- [å½±ç‰‡ä¸­çš„ç¶²ç«™](https://andersbrownworth.com/blockchain/block)

6. å€å¡Šçš„å»£æ’­å’Œæœ€çµ‚ç¢ºèª

   - ç¬¬ä¸€å€‹æ‰¾å‡º nonce çš„ç¯€é»å–å¾—å°‡é€™å€‹å€å¡Šå¯«å…¥çš„è³‡æ ¼å¾Œï¼Œæœƒå…ˆå°‡é€™å€‹ block æ›´æ–°åˆ°è‡ªå·±çš„éˆï¼Œä¸¦å°é™„è¿‘ç¯€é»å»£æ’­
   - é„°è¿‘ç¯€é»æ¥æ”¶åˆ°è€…å€‹æ–°çš„ block å¾Œï¼Œæœƒå°é€™å€‹ block é€²è¡Œé©—è­‰ï¼Œå¦‚æœé©—è­‰é€šéå°±æœƒå°‡é€™å€‹ block æ›´æ–°è‡ªå·±çš„éˆï¼Œä¸¦æŠŠå·²å®Œæˆçš„äº¤æ˜“å¾ mempool æˆ–æ˜¯ potential block ä¸­ç§»é™¤
   - æŒ–ç¤¦çš„ç¯€é»å–å¾—çå‹µ

Source: https://ithelp.ithome.com.tw/articles/10287341

### Proof-Of-Stake (PoS)

> **Proof-Of-Stake æ˜¯ä»€éº¼ï¼Ÿ**

Proof-of-Stakeï¼ˆPoSï¼‰æ˜¯ä¸€ç¨®ç”¨æ–¼å€å¡Šéˆç¶²çµ¡çš„å…±è­˜ç®—æ³•ï¼Œèˆ‡ Proof-of-Workï¼ˆPoWï¼‰ä¸åŒï¼Œå®ƒä¸ä¾è³´æ–¼è¤‡é›œçš„æ•¸å­¸å•é¡Œå’Œå¤§é‡çš„è¨ˆç®—èƒ½åŠ›ä¾†é”æˆç¶²çµ¡å…±è­˜ã€‚åœ¨ PoS ä¸­æ˜¯ç”±éš¨æ©Ÿé¸å®šçš„ä¸€å€‹ validator ä¾†åšå¯«å…¥ã€é©—è­‰å€å¡Šï¼Œé›–ç„¶ä¸åŒçš„å…±è­˜æ©Ÿåˆ¶åšæ³•ä¸åŒï¼Œä½†éƒ½æ˜¯ç‚ºäº†é”åˆ°ä¸€å€‹ç›®çš„ï¼šé”åˆ°å…±è­˜ä¸¦ç¢ºä¿ç¶²è·¯çš„å®‰å…¨æ€§ã€‚

> **Validator æ˜¯ä»€éº¼ï¼Ÿ**

æ”¶é›†äº¤æ˜“ã€æ‰“åŒ…é€²ä¸€å€‹æ–°çš„å€å¡Šï¼Œä¸¦å°‡è©²å€å¡Šæäº¤åˆ°éˆä¸Šã€‚é™¤äº†æè­°æ–°å€å¡Šï¼Œé©—è­‰è€…é‚„éœ€è¦å°å…¶ä»–é©—è­‰è€…æè­°çš„å€å¡Šé€²è¡Œå°è­‰ã€‚
åœ¨ä»¥å¤ªåŠ Proof-of-Stakeï¼ˆPoSï¼‰å”è­°ä¸­ï¼Œé¸æ“‡æäº¤ï¼ˆæè­°ï¼‰æ–°å€å¡Šçš„é©—è­‰è€…ï¼ˆvalidatorï¼‰æ˜¯ä¸€å€‹éš¨æ©Ÿéç¨‹ï¼Œé€šå¸¸åŸºæ–¼å¤šç¨®å› ç´ ï¼ŒåŒ…æ‹¬é©—è­‰è€…çš„æŠµæŠ¼é‡‘ã€æŒæœ‰çš„æ™‚é–“é•·çŸ­ã€ä»¥å¾€çš„åƒèˆ‡åº¦ä»¥åŠç­‰å› ç´ ã€‚
æˆç‚ºä¸€å€‹é©—è­‰è€…ï¼ˆvalidatorï¼‰åŸºæœ¬è¦æ±‚ï¼š 32 ETH æŠµæŠ¼é‡‘ã€ä¸€å°å…·æœ‰ç©©å®šç¶²çµ¡é€£æ¥å’Œè¶³å¤ é‹è¡Œèƒ½åŠ›çš„é›»è…¦ã€‚

åœ¨ä¸€å€‹ Stake Pool ä¸­ï¼Œå¤šå€‹å°é¡æŒæœ‰è€…å¯ä»¥ã€Œå§”è¨—ã€ï¼ˆdelegateï¼‰ä»–å€‘çš„è³‡é‡‘åˆ°ä¸€å€‹å…¬å…±æ± ä¸­ã€‚é€™å€‹æ± ç”±ä¸€å€‹æˆ–å¤šå€‹å°ˆæ¥­çš„æ± é‹ç‡Ÿè€…ç®¡ç†ï¼Œä»–å€‘è² è²¬ä¿æŒç¶²çµ¡ç¯€é»çš„é‹è¡Œå’Œåƒèˆ‡å…±è­˜æ©Ÿåˆ¶ã€‚ç•¶ Stake Pool æˆåŠŸåœ°åƒèˆ‡å€å¡Šå‰µå»ºæˆ–é©—è­‰éç¨‹æ™‚ï¼Œå…¶æ”¶åˆ°çš„çå‹µæœƒæŒ‰ç…§æŸç¨®åˆ†é…æ©Ÿåˆ¶ï¼ˆé€šå¸¸èˆ‡å„åƒèˆ‡è€…çš„å§”è¨—é‡‘é¡æˆæ­£æ¯”ï¼‰åˆ†çµ¦æ± ä¸­çš„æ‰€æœ‰åƒèˆ‡è€…ã€‚

> #### PoW èˆ‡ PoS çš„å·®ç•° {#hw5-1}

ä¸»è¦å·®ç•°åœ¨æ–¼ PoS æ›´åŠ ç¯€èƒ½ï¼Œå°æ–¼é›†ä¸­ç¨‹åº¦å…©è€…çš†æœ‰ä¸åŒå‚¾å‘çš„é›†ä¸­åŒ–ï¼ŒPOW ç®—åŠ›é›†ä¸­æ–¼ç¤¦å ´ï¼ŒPOS å‰‡æ˜¯æ“æœ‰è¼ƒå¤š ETH å®¹æ˜“æ›´é›†ä¸­ã€‚åœ¨å…©ç¨®å…±è­˜æ©Ÿåˆ¶ä¸‹éƒ½æœƒæœ‰å› ç‚ºä¸åŒåˆ¶åº¦è€Œæœ‰ä¸åŒçš„æ”»æ“Šã€‚

|            | PoW                                                        | PoS                                                                                                       |
| ---------- | ---------------------------------------------------------- | --------------------------------------------------------------------------------------------------------- |
| èªè­‰äº¤æ˜“è€… | miner                                                      | validator                                                                                                 |
| Stake      | æ¯å€‹äººéƒ½å¯ä»¥æˆç‚ºç¤¦å·¥ä¸éœ€ Stake                             | éœ€è¦ 32 ETH æŠµæŠ¼æ‰èƒ½æˆç‚º validator                                                                        |
| å€å¡Šå‰µå»º   | æœ€å¿«è§£å‡º nonce çš„ç¯€é»å–å¾—å¯«å…¥å€å¡Šçš„æ¬Šåˆ©                    | æ ¹æ“šå…¶æŒæœ‰çš„ä»£å¹£æ•¸é‡ã€æŠµæŠ¼æ™‚é–“ã€éš¨æ©ŸåŒ–ç®—æ³•ç­‰å› ç´ ä¾†é¸æ“‡çš„ validator                                        |
| çå‹µæ©Ÿåˆ¶   | ç¤¦å·¥é€šéè§£æ±ºæ•¸å­¸å•é¡Œä¾†ç²å¾—æ–°å‰µå»ºçš„ä»£å¹£å’Œäº¤æ˜“è²»ç”¨ä½œç‚ºçå‹µã€‚ | é©—è­‰è€…é€šéæŠµæŠ¼ä»–å€‘æŒæœ‰çš„ä»£å¹£ä¾†åƒèˆ‡å€å¡Šçš„å‰µå»ºå’Œé©—è­‰ï¼Œä¸¦ç²å¾—ç›¸æ‡‰çš„çå‹µï¼ˆé€šå¸¸æ˜¯äº¤æ˜“è²»ç”¨å’Œ/æˆ–æ–°å‰µå»ºçš„ä»£å¹£ï¼‰ã€‚ |
| æ¶ˆè€—       | éœ€è¦å¤§é‡é‹ç®—èƒ½åŠ›                                           | ä¸éœ€è¦å¤§é‡é‹ç®—èƒ½åŠ› ETH                                                                                    |
| æ”»æ“Š       | 51% æ”»æ“Š                                                   |

> #### ç‚ºä»€éº¼ Ethereum å¾ PoW è½‰ç‚º PoS {#hw5-2}

- PoS æä¾›äº†ä¸€ç¨®æ›´ç‚ºç’°å¢ƒå‹å¥½çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå› ç‚ºå®ƒä¸éœ€è¦å¤§é‡çš„è¨ˆç®—èƒ½åŠ›å’Œèƒ½æºæ¶ˆè€—ã€‚
- é™ä½ç¡¬é«”è¨­å‚™çš„é–€æª»
- è§£æ±ºæ€§èƒ½
- å®‰å…¨
- é¿å…ç®—åŠ›é›†ä¸­ï¼šPoW ç®—æ³•å¾€å¾€æœƒå°è‡´è¨ˆç®—èƒ½åŠ›é›†ä¸­åœ¨å°‘æ•¸å¤§å‹ç¤¦å ´ï¼Œé€™æ¨£çš„é›†ä¸­åŒ–å¯èƒ½æœƒå½±éŸ¿ç¶²çµ¡çš„å®‰å…¨æ€§å’Œå»ä¸­å¿ƒåŒ–ç¨‹åº¦ã€‚PoS æœ‰åŠ©æ–¼å¯¦ç¾æ›´å»£æ³›çš„ç¯€é»åƒèˆ‡å’Œæ›´é«˜ç¨‹åº¦çš„å»ä¸­å¿ƒåŒ–ã€‚

> **Ethereum å¦‚ä½•å¾ PoW è½‰ç‚º PoS**

ä»¥ä¸‹æ˜¯é€™ä¸€éç¨‹çš„ä¸€äº›ä¸»è¦éšæ®µï¼š

![](https://hackmd.io/_uploads/By22FUqR2.png)

Source: https://ethereum.org/zh-tw/roadmap/merge/

#### Phase 0: Beacon Chain ä¿¡æ¨™éˆ

é€™æ˜¯ä»¥å¤ªåŠ 2.0 çš„ç¬¬ä¸€å€‹éšæ®µï¼Œæ–¼ 2020 å¹´ 12 æœˆ 1 æ—¥å•Ÿå‹•ã€‚Beacon Chain æ˜¯ä¸€å€‹å…¨æ–°çš„ PoS å€å¡Šéˆï¼Œä¸¦ä¸”èˆ‡ç¾æœ‰çš„ä»¥å¤ªåŠ 1.0ï¼ˆPoWï¼‰éˆå¹³è¡Œé‹è¡Œã€‚åœ¨é€™ä¸€éšæ®µï¼Œé©—è­‰è€…å¯ä»¥é–‹å§‹æŠµæŠ¼ï¼ˆstakingï¼‰ä»¥å¤ªå¹£ï¼ˆETHï¼‰åˆ° Beacon Chainï¼Œä½†æš«æ™‚ä¸èƒ½åŸ·è¡Œæ™ºèƒ½åˆç´„æˆ–é€²è¡Œäº¤æ˜“ã€‚

#### Phase 1: Shard Chains

é€™ä¸€éšæ®µé è¨ˆå°‡æ·»åŠ  64 å€‹åˆ†ç‰‡éˆï¼ˆshard chainsï¼‰åˆ° Beacon Chainã€‚åˆ†ç‰‡æŠ€è¡“å…è¨±ç¶²çµ¡ä»¥æ›´é«˜çš„ååé‡é€²è¡Œäº¤æ˜“å’Œæ™ºèƒ½åˆç´„æ“ä½œï¼Œå¾è€Œæé«˜å…¶å¯æ“´å±•æ€§ã€‚

#### Phase 1.5: Docking

åœ¨é€™ä¸€éšæ®µï¼Œç¾æœ‰çš„ä»¥å¤ªåŠ 1.0 éˆå°‡æˆç‚ºä»¥å¤ªåŠ 2.0 çš„ä¸€å€‹åˆ†ç‰‡ã€‚é€™æ¨£ï¼Œç¾æœ‰çš„æ‡‰ç”¨å’Œåˆç´„å°‡èƒ½å¤ ç„¡ç¸«é‹è¡Œåœ¨æ–°çš„ PoS éˆä¸Šã€‚

#### Phase 2: State Execution Engines

é€™ä¸€éšæ®µå°šæœªå®Œå…¨ç¢ºå®šï¼Œä½†é è¨ˆå°‡ç‚ºåˆ†ç‰‡æ·»åŠ æ›´å¤šçš„åŠŸèƒ½å’Œæ”¹é€²ã€‚
å®ƒå¯èƒ½åŒ…æ‹¬æ›´éˆæ´»çš„åˆç´„åŸ·è¡Œã€è·¨åˆ†ç‰‡äº¤æ˜“ç­‰ã€‚

Source: [ä»¥å¤ªåŠ 2.0ã€ä¿¡æ¨™éˆã€åˆ†ç‰‡å’Œ PoS éƒ½æ˜¯ä»€éº¼æ„æ€ï¼Ÿ](https://www.youtube.com/watch?v=exblsy1krYw)

<Admonition type="info" icon="ğŸ’¡" title="Concept">

- PoW, PoS
- Nonce
- Mining
- Ethereum PoW to PoS

</Admonition>

## Account

---

An account is not a wallet. An account is the keypair for a user-owned Ethereum account. A wallet is an interface or application that lets you interact with your Ethereum account.

> **Account é¡åˆ¥**

- EOA
- Contract Account

> #### Account Field {#hw2-2}

![](https://hackmd.io/_uploads/rJ0cwNcR2.png)
Source: https://ethereum.org/zh-tw/developers/docs/evm/

1. **nonce (äº¤æ˜“ç¢ºèªæ¬¡æ•¸)** : Account Nonce ä¸¦ä¸æ˜¯ Ethereum Blockchain ä¸­çš„ä¸€å€‹ Global Stateï¼Œè€Œæ˜¯ä¸€å€‹å‹•æ…‹è¨ˆç®—å‡ºä¾†çš„çµæœï¼Œé€šå¸¸ä»£è¡¨ç›®æ¨™åœ°å€ï¼ˆEOAï¼‰ç™¼å‡ºéçš„ Confirmedï¼ˆå·²æ‰“åŒ…ï¼‰ äº¤æ˜“æ•¸ï¼ŒåŒä¸€å€‹ Account äº¤æ˜“çš„åŸ·è¡Œé †åºä»¥åŠç¤¦å·¥æŒ‘é¸äº¤æ˜“åŸ·è¡Œé †åºéƒ½è·Ÿ Nonce æœ‰é—œï¼Œä¸å¯ä»¥è·³è™Ÿï¼Œè¦éå¢ä¸¦ä¸”é€£è™Ÿçš„åŸ·è¡Œã€‚Account Nonce é€šå¸¸ç”¨ä¾†è§£æ±ºå…©å€‹å•é¡Œï¼šä¸€å€‹æ˜¯äº¤æ˜“çš„åŸ·è¡Œé †åº(é›™é‡æ”¯ä»˜ Double Spending)ï¼Œå¦å¤–ä¸€å€‹å‰‡æ˜¯ç”¨ä¾†é˜²ç¯„ [replay attack](#replay-attack)ã€‚

2. **balance** : é€™å€‹åœ°å€æŒæœ‰å¤šå°‘ wei

3. **codeHash** :
   EOA é€™å€‹æ¬„ä½æ˜¯ç©ºç™½çš„ã€‚ç•¶æ™ºèƒ½åˆç´„è¢«éƒ¨ç½²åˆ°å€å¡Šéˆä¸Šå¾Œï¼Œbytecodev è¢«å­˜å„²åœ¨å€å¡Šéˆçš„ç‹€æ…‹ä¸­ï¼Œç”¨ä¾†ç¢ºä¿æ™ºèƒ½åˆç´„çš„ bytecode åœ¨ä¸€æ—¦éƒ¨ç½²å¾Œä¸æœƒè¢«ç¯¡æ”¹ã€‚

4. **storageRoot**

Source: https://ethereum.org/zh-tw/developers/docs/accounts/

> ### ä»€éº¼æ˜¯ Replay Attacksï¼Ÿ {#replay-attack}

Replay Attacks çš„æ„æ€æ˜¯ç•¶æˆ‘å€‘çš„äº¤æ˜“è¢«æ‰“åŒ…åˆ°å€å¡Šéˆä¸Šä¹‹å¾Œï¼Œå°±æœƒæˆç‚ºä¸€å€‹å…¬é–‹é€æ˜çš„è³‡è¨Šï¼Œé‚£æœ‰å¿ƒäººå£«æ˜¯ä¸æ˜¯å°±å¯ä»¥è¤‡è£½ä»–å€‘ç„¶å¾Œé€åˆ°å€å¡Šéˆç¶²è·¯ä¸­å‘¢ï¼Œä¾‹å¦‚æˆ‘å€‘è¤‡è£½æŸå€‹äººè¦åŒ¯æ¬¾çµ¦æˆ‘å€‘çš„äº¤æ˜“ç„¶å¾Œä¸æ–·åŸ·è¡Œå®ƒå€‘ï¼Œæ˜¯ä¸æ˜¯å°±å¯ä»¥æŠŠæŸå€‹äººçš„å¸³æˆ¶æç©ºï¼é€™æ™‚å€™ Nonce ä¾¿æ˜¯åœ¨å…¶ä¸­ä½¿å…¶æœ‰ä¸€å€‹æ“¾å‹•çš„çµ„æˆï¼ŒNonce ä½¿å¾—é€å‡ºäº¤æ˜“çš„äººå¿…é ˆæ¯æ¬¡éƒ½ Signï¼Œå› ç‚ºå³ä¾¿äº¤æ˜“å…§å®¹ç›¸åŒï¼ˆæ”¶æ¬¾äººã€Value ç›¸åŒï¼‰ï¼ŒNonce ä¹Ÿæ˜¯ä¸åŒçš„ã€‚æ­¤å¤–ï¼Œå¦‚æœç¤¦å·¥ç™¼ç¾ç•¶å‰è™•ç†çš„äº¤æ˜“æ˜¯éå¾€æŸä¸€ç­†äº¤æ˜“çš„è¤‡è£½å“ï¼Œé‚£å°±æœƒæ‹’çµ•æ‰“åŒ…é€™ç­†äº¤æ˜“ã€‚

Source: https://ithelp.ithome.com.tw/articles/10287340

> #### å€å¡Šçš„ Nonce èˆ‡ Ethereum äº¤æ˜“çš„ Nonce åˆ†åˆ¥æ˜¯ä»€éº¼æ„æ€ï¼Ÿè§£æ±ºä»€éº¼å•é¡Œï¼Ÿ {#hw3}

å€å¡Šä¸­çš„ nonce æ˜¯ä¸€å€‹éš¨æ„æ•¸ï¼Œç¤¦å·¥å°‡ Nonce èˆ‡äº¤æ˜“é€²è¡Œ SHA-256 é‹ç®—ç”¢ç”Ÿ hashï¼Œæ‰¾åˆ°ç¬¦åˆæ¢ä»¶çš„ Nonce å³æœ‰æ¬Šç²å¾—å¯«å…¥æ–°å€å¡Šçš„æ¬Šåˆ©ã€‚åœ¨ PoW å…±è­˜æ©Ÿåˆ¶ä¸­ï¼Œç”¨ä¾†é¿å…ç™¼ç”Ÿæƒ¡æ„æ”»æ“Šã€ä¿éšœç¶²çµ¡çš„ä¸å¯ç¯¡æ”¹æ€§ã€å®‰å…¨æ€§ã€‚

Ethereum accoount ä¸­çš„ Nonce æ˜¯æŒ‡ EOA ç™¼å‡ºçš„äº¤æ˜“ç¢ºèªæ¬¡æ•¸ï¼Œä¸å¯è·³è™Ÿï¼Œç¢ºä¿äº¤æ˜“æŒ‰ç…§ç‰¹å®šçš„é †åºåŸ·è¡Œã€‚

å€å¡Šçš„ Nonce ä¸»è¦ç”¨æ–¼å¯¦ç¾å·¥ä½œé‡è­‰æ˜å’Œå¢åŠ ç¶²çµ¡å®‰å…¨ï¼Œè€Œ Ethereum çš„äº¤æ˜“ Nonce å‰‡ç”¨æ–¼ç¢ºä¿äº¤æ˜“é †åºå’Œå®‰å…¨ã€‚å…©è€…éƒ½æ˜¯ç‚ºäº†å¢åŠ æ•´å€‹ç³»çµ±çš„å¥å£¯æ€§å’Œå®‰å…¨æ€§ã€‚

### Address, Public Key, Private Key

> #### å¦‚ä½•ç”¢ç”Ÿç§é‘°ã€å…¬é‘°ã€åœ°å€ï¼Ÿ {#hw4-1}

1. çµ¦å®šä¸€å€‹éš¨æ©Ÿç”¢ç”Ÿï¼Œé•·åº¦ç‚º 64 Hex Char çš„ Private Key
2. ä½¿ç”¨ Elliptic Curve Digital Signature Algorithm (ECDSA) é‹ç®—å°‡ Private Key åŒ–ç‚º Public Key
3. ä½¿ç”¨ Keccak-256 å°‡ Public Key é€²è¡Œ Hashingï¼Œä¸¦å°‡çµæœå–ã€Œå¾Œ 40 characters / 20 bytesã€ï¼Œä¸¦åœ¨å‰æ–¹åŠ ä¸Š 0x å³å¯å¾—åˆ°æœ€çµ‚çš„ Addressï¼ˆé•·åº¦ç‚º 40 + 2 charactersï¼‰

| Types       | (hex) characters | bits | bytes | example |
| ----------- | ---------------- | ---- | ----- | ------- |
| Private Key | 64               | 256  | 32    |         |
| Public Key  | 128              | 512  | 64    |         |
| Address     | 40               | 160  | 20    |         |

> #### å¦‚ä½•ç”¨ Private key Signing {#hw4-2}

> #### Transaction Hash å¦‚ä½•ç”¢ç”Ÿï¼Ÿ {#hw2-3}

![](https://hackmd.io/_uploads/SJr2tGqCh.png)
Source: [Electronic_signature](https://en.wikipedia.org/wiki/Electronic_signature)

1. æœ‰ä¸€ç­†äº¤æ˜“ tx

   ```js title="Tx Object"
   tx = {
    nonce = 9,
    gasprice = 20 * 10 ** 9,
    startgas = 21000,
    to = 0x3535353535353535353535353535353535353535,
    value = 10 ** 18,
    data = "",
   };
   ```

2. å°‡ tx é€²è¡Œ RLP å¯ä»¥å¾—åˆ° Signing Data ç‚ºï¼š

   ```md title="Signing Data"
   0xec098504a817c8008252089435353535353535353535
   35353535353535353535880de0b6b3a764000080018080
   ```

3. Signing Data é€²è¡Œ keccak256 Hash å¾—åˆ° Signing Hash ç‚ºï¼š

   ```md title="Signing Hash"
   0xdaf5a779ae972f972197303d7b574746c7ef83eadac0
   f2791ad23db92e4c8e53
   ```

4. å°‡ Signing Hash ç”¨ Private Key sign (secp256k1) ç”¢ç”Ÿ Signature (v, r, s)

   ```md title="Signature"
   (v, r, s) =
   (37,
   18515461264373351373200002665853028612451056578545711640558177340181847433846, 46948507304638947509940763649030358759909902576025900602547168820602576006531)
   ```

5. tx + Signature (v, r, s) ä¸€èµ·åš RLP ç”¢ç”Ÿ Signed Transaction = rawTransaction = Transaction Hash

Source : [Smart Contract Development Breakdown éµäººè³½ Day 17 - Cryptography](https://ithelp.ithome.com.tw/articles/10287338)

> #### å¦‚ä½•ç”¨ Public key Verificationï¼Ÿ

ç•¶æˆ‘å€‘è¦é©—è­‰ä¸€å€‹ Digital Signature æ™‚ï¼Œå‰‡éœ€è¦ä½¿ç”¨ Signature ä¸­çš„ s ä¾†ä»£å…¥ ECDSA è¨ˆç®—ï¼Œä¸¦æŸ¥çœ‹å¾—åˆ°çš„ r æ˜¯å¦åˆæ³•ã€‚

1. æ”¶åˆ°ç°½åå’Œä¿¡æ¯ï¼šæ”¶åˆ° signature å’Œæœªç¶“ä¿®æ”¹çš„åŸå§‹ä¿¡æ¯ã€‚
2. è¨ˆç®—ä¿¡æ¯çš„å“ˆå¸Œå€¼ï¼šä½¿ç”¨å’Œç™¼é€è€…ç›¸åŒçš„å“ˆå¸Œç®—æ³•ï¼ˆä¾‹å¦‚ï¼ŒSHA-256ï¼‰ä¾†è¨ˆç®—åŸå§‹ä¿¡æ¯çš„å“ˆå¸Œå€¼ã€‚
3. è§£å¯†ç°½åï¼šä½¿ç”¨ç™¼é€è€…çš„å…¬é‘°å’Œ RSA ç®—æ³•ä¾†è§£å¯†å·²ç°½åçš„ä¿¡æ¯ï¼ˆå³ç°½åçš„å“ˆå¸Œå€¼ï¼‰ã€‚
4. æ¯”è¼ƒå“ˆå¸Œå€¼ï¼šå°‡è§£å¯†å¾—åˆ°çš„å“ˆå¸Œå€¼èˆ‡ä½ è‡ªå·±è¨ˆç®—çš„å“ˆå¸Œå€¼é€²è¡Œæ¯”è¼ƒã€‚å¦‚æœå…©è€…åŒ¹é…ï¼Œå‰‡ç°½åæ˜¯æœ‰æ•ˆçš„ï¼Œé€™è­‰æ˜è©²ä¿¡æ¯ç¢ºå¯¦ä¾†è‡ªè²ç¨±çš„ç™¼é€è€…ã€‚

![](https://hackmd.io/_uploads/Bk9U-DqRn.png)

Source: https://medium.com/@enterprise.eric320/ä¸æ‡‚ç¨‹å¼-ä¹Ÿèƒ½ç†è§£çš„å€å¡ŠéˆéŒ¢åŒ…æŠ€è¡“åŸç†-äºŒ-éå°ç¨±åŠ å¯†-æ•¸ä½ç°½ç« -a401f4cce623

> **ä»€éº¼æ˜¯ Seed Phraseï¼Ÿ**

æ˜¯ä¸€ç¨®ç”¨æ–¼ç”Ÿæˆå’Œæ¢å¾©ç§é‘°çš„æ–¹æ³•ã€‚é€šå¸¸ç”± 12ã€18 æˆ– 24 å€‹è‹±æ–‡å–®è©çµ„æˆï¼Œé€™äº›å–®è©æŒ‰ç…§ä¸€å®šé †åºæ’åˆ—ï¼Œå¯ç”Ÿæˆç§é‘°ã€‚

### Cryptography

> **ä»€éº¼æ˜¯ RLP (Recursive Length Prefix)?**

- RLP çš„ç·¨ç¢¼è¦å‰‡
- RLP çš„è§£ç¢¼è¦å‰‡

> **ä»€éº¼æ˜¯ ECDSAï¼Ÿ**

ECDSA æ˜¯é‹ç”¨äº†æ©¢åœ“æ›²ç·šå¯†ç¢¼å­¸æ‰€é”æˆçš„æ•¸ä½ç°½ç« æ¼”ç®—æ³•ã€‚

- ECDSA çš„ç·¨ç¢¼è¦å‰‡
- ECDSA çš„è§£ç¢¼è¦å‰‡

> **ä»€éº¼æ˜¯ SHA-256ï¼Ÿ**

SHA-256ï¼ˆSecure Hash Algorithm 256-bitï¼‰æ˜¯ä¸€ç¨®åŠ å¯†å“ˆå¸Œå‡½æ•¸ã€‚æ¥å—ä¸€å€‹è¼¸å…¥ï¼ˆæˆ–ç¨±ç‚º"è¨Šæ¯"ï¼‰ä¸¦è¿”å›ä¸€å€‹å›ºå®šé•·åº¦ï¼ˆ256 ä½ï¼Œæˆ– 32 å­—ç¯€ï¼‰çš„å“ˆå¸Œå€¼ã€‚SHA-256 æ˜¯ä¸€ç¨®å–®å‘å‡½æ•¸ï¼Œæ„å‘³è‘—å¾è¼¸å‡ºå“ˆå¸Œå€¼åŸºæœ¬ä¸Šä¸èƒ½æ¨ç®—å›åŸå§‹è¼¸å…¥ã€‚é€™æ˜¯ä¸€å€‹é‡è¦çš„ç‰¹æ€§ï¼Œç”¨æ–¼ç¢ºä¿æ•¸æ“šçš„å®‰å…¨æ€§ã€‚

### Wallet

éŒ¢åŒ…ï¼ˆWalletï¼‰æ˜¯ç”¨æ–¼ç®¡ç†ã€å­˜å„²å’Œé€²è¡ŒåŠ å¯†è²¨å¹£äº¤æ˜“çš„ä¸€å€‹è»Ÿé«”æˆ–ç¡¬é«”æ‡‰ç”¨ã€‚éŒ¢åŒ…å¯¦éš›ä¸Šä¸æœƒâ€œå­˜å„²â€è²¨å¹£ï¼Œè€Œæ˜¯å­˜å„²ä¸€å°å¯†é‘°â€”â€”å…¬é‘°å’Œç§é‘°â€”â€”é€™å…©è€…ç”¨æ–¼é©—è­‰äº¤æ˜“å’Œç®¡ç†è³‡ç”¢ã€‚

> **éŒ¢åŒ…çš„é¡å‹**

1. ç†±éŒ¢åŒ…ï¼ˆHot Walletï¼‰ï¼šåƒæ˜¯ Metamask
2. å†·éŒ¢åŒ…ï¼ˆCold Walletï¼‰æˆ–ç¡¬é«”éŒ¢åŒ… : åƒæ˜¯ ledger
3. ç´™éŒ¢åŒ…ï¼ˆPaper Walletï¼‰
4. ç§»å‹•éŒ¢åŒ…ï¼ˆMobile Walletï¼‰
5. ç¶²é éŒ¢åŒ…ï¼ˆWeb Walletï¼‰
6. æ¡Œé¢éŒ¢åŒ…ï¼ˆDesktop Walletï¼‰

<Admonition type="info" icon="ğŸ’¡" title="Concept">

- EOA, Contract Account
- Nonce
- Address, Public Key, Private Key
- Transaction Hash
- Signing, Verification
- RLP, ECDSA
- Wallet

</Admonition>

## Transaction {#hw2-1}

---

äº¤æ˜“åªèƒ½ç”± EOA ç™¼èµ·ï¼Œäº¤æ˜“çš„åŸ·è¡Œæœƒå»æ”¹è®Š EVM state

### Tx Object

1. **from**ï¼šsender çš„åœ°å€ï¼Œåªæœƒæœ‰ EOA å› ç‚º contract account ç„¡æ³•ç™¼å‡ºäº¤æ˜“
2. **to**ï¼šrecipient addressï¼Œå¦‚æœæ˜¯ EOA transfer value ï¼Œå¦‚æœæ˜¯ contract account åŸ·è¡Œ contract code
3. **value**ï¼šè¦å¾ sender è½‰åˆ° recipient å¤šå°‘æ•¸é‡çš„ ETHï¼Œä»¥ WEI å–®ä½è¡¨ç¤ºï¼Œ1ETH ç­‰æ–¼ 1e+18wei ETH å–®ä½æ›ç®—
4. **input** dataï¼šoptional field ä¸€èˆ¬äº¤æ˜“é€™å€‹æ¬„ä½æœƒæ˜¯ç©ºç™½(0x)ï¼Œ smart contract å‰‡æœƒæ”¾ parameter or operation that we want to call on smart contract
5. **nonce**ï¼šaccount çš„äº¤æ˜“æ•¸ï¼Œa sequentially incrementing counter é¿å…ç™¼ç”Ÿé‡è¤‡äº¤æ˜“
6. **gasLimit**ï¼šé€™ç­†äº¤æ˜“æœ€å¤šå¯ä»¥æ¶ˆè€—çš„ gas å–®ä½
7. **maxFeePerGas**ï¼šé€™ç­†äº¤æ˜“æ¯å–®ä½ gas æœ€å¤šé¡˜æ„è² æ“”çš„ feeï¼ŒåŒ…å« baseFeePerGas å’Œ maxPriorityFeePerGas
8. **maxPriorityFeePerGas**ï¼šé€™ç­†äº¤æ˜“æœ€å¤šå¯ä»¥çµ¦ validator çš„å°è²»
9. **signature(v, r, s)**ï¼šsender ç”¨ private key sign transaction ç”¢ç”Ÿçš„

```js title="Tx Object"
{
  from: "0xEA674fdDe714fd979de3EdF0F56AA9716B898ec8",
  to: "0xac03bb73b6a9e108530aff4df5077c2b3d481e5a",
  gasLimit: "21000",
  maxFeePerGas: "300",
  maxPriorityFeePerGas: "10",
  nonce: "0",
  value: "10000000000"
}

```

> **å–®ä½æ›ç®—**

![](https://hackmd.io/_uploads/rySCTEc0n.png)

> **Transaction é¡å‹**

1. å–®ç´”çš„ Ether è½‰å¸³äº¤æ˜“
2. éƒ¨ç½²æ™ºæ…§åˆç´„
3. å‘¼å«åˆç´„é€²è¡Œäº’å‹•

### Gas

> **Gas æ¶ˆè€—å¦‚ä½•è¨ˆç®—ï¼Ÿ**

Source: https://ethereum.org/zh-tw/developers/docs/gas/#how-are-gas-fees-calculated

<Admonition type="info" icon="ğŸ’¡" title="Concept">

- Tx Object
- Gas

</Admonition>

## Resources

---

- Docs

  - [Ethereum Docs](https://ethereum.org/zh-tw/developers/docs/)

- æ–‡ç« 

  - [Pelith Medium ã€Šå€å¡ŠéˆæŠ€è¡“çŸ¥è­˜ã€‹ç›®éŒ„](https://medium.com/pelith/blockchain-technical-overview-8c2a643424fa)
  - [Smart Contract Development Breakdown éµäººè³½](https://ithelp.ithome.com.tw/users/20140105/ironman/5075)

- Videos
  - [Youtube - Ethereum - Tutorial 5 - Blockchain, Blocks, and Mining](https://www.youtube.com/watch?v=zQdoOrVXVSU)
  - [Youtube - EVM-based Blockchain Development (Ethereum) 101](https://www.youtube.com/playlist?list=PLvfQp12V0hS1LmcDq23mdocEaMVHtp_IK)
  - [é™³æ˜¶å¾ | A Tour of Ethereum Ecosystem | Taipei Ethereum Meetup](https://www.youtube.com/watch?v=uFBu2P1mwFU)
  - [Anders Brownworth Blockchain 101 å½±ç‰‡](https://www.youtube.com/watch?v=_160oMzblY8)

## E-Portfolio

|       | Hours | ç´€éŒ„                                                            |
| :---: | :---: | --------------------------------------------------------------- |
|  Mon  |   1   | å‰›é–‹å§‹å¾é¡Œç›®å»æœå°‹ç­”æ¡ˆæ™‚è¦ºå¾—åˆ†æ•£è‘—çœ‹æ–‡ç« æœ‰é»é›¶æ•£                |
|  Tue  |   2   | çœ‹æä¾›çš„æ¨è–¦å½±ç‰‡                                                |
|  Wed  |   2   | é–‹å§‹çœ‹ Ethereum æ–‡ä»¶ï¼Œç™¼ç¾ä»–çš„æ¶æ§‹æ»¿æ¸…æ¥šçš„ï¼Œæ–‡ç« ä¹Ÿå¾ˆå¸¸æ›´æ–°      |
|  Thu  |   1   | é‚Šçœ‹æ–‡ä»¶é‚Šçœ‹å…©å€‹ Youtube ç³»åˆ—ï¼Œå‰é¢éƒ¨ä»½ä»‹ç´¹å€å¡Šéˆã€ä»¥å¤ªåŠçš„æ¦‚å¿µ |
|  Fri  |   2   | å°‡é–±è®€å¾Œæœ‰çš„å¤§æ¦‚æ¦‚å¿µåˆ—å‡ºæ¶æ§‹                                    |
|  Sat  |   8   | å¾åˆ—å‡ºçš„æ¶æ§‹å¯«ä½œæ¥­æ–‡ç« ï¼Œå…ˆäº†è§£åˆæ­¥æ¦‚å¿µå¾Œï¼Œåœ¨æœå°‹æ–‡ç« æ·±å…¥äº†è§£    |
|  Sun  |   8   | å¯«çš„æ™‚å€™ç¸½æ˜¯å¡ä½å†å›å»é‡æ–°çœ‹æ–‡ä»¶è·Ÿå½±ç‰‡                          |
| Total |  24   |                                                                 |

#### æœ¬é€±å­¸ç¿’ç¸½çµ

é€™é€±å¾ä¸€é–‹å§‹é€éé¡Œç›®æ‘¸ç´¢å¥½åƒæœ‰é»é›¶æ•£ï¼Œå¾Œä¾†é€é Ethereum å®˜æ–¹æ–‡ä»¶çš„æ¶æ§‹å»å­¸ç¿’ï¼Œæ¯”è¼ƒæœ‰åŸºæœ¬çš„æ¶æ§‹è·Ÿè„ˆçµ¡ï¼Œé€éé€™å€‹æ¶æ§‹å°‡ä¸çŸ¥é“çš„éƒ¨åˆ†æ…¢æ…¢è£œé½Šã€‚é€éé€™æ¨£çš„æ–¹å¼æˆ‘è¦ºå¾—æ»¿æ¸…æ¥šçš„ï¼Œå¯ä»¥å†ç”¨é€™æ¨£çš„æ–¹å¼ç¹¼çºŒå¯¦é©—æ‰¾å‡ºæ›´å¥½çš„å­¸ç¿’æ–¹å¼ã€‚

#### æœ¬é€±å­¸ç¿’æª¢è¨

å› ç‚ºå¹³å¸¸æ²’æœ‰ç¿’æ…£åœ¨åšæŠ€è¡“æ–‡ç« çš„ç”¢å‡ºï¼Œå› æ­¤ç”¢å‡ºä½œæ¥­æ™‚å€™å¡äº†æœ‰é»ä¹…ï¼Œå¾è‹±æ–‡ç¿»è­¯å†è®Šæˆè‡ªå·±çš„æ–‡å­—ï¼Œéœ€è¦åˆ°éå¸¸ç†Ÿæ‚‰ï¼Œå¸Œæœ›æŒçºŒç·´ç¿’é€™æ¨£ç”¢å‡ºæ–¹å¼ã€‚

#### ä¸‹é€±å­¸ç¿’ç›®æ¨™

ä¸‹é€±æ˜¯å­¸ç¿’ Solidity çš„åŸºç¤èª²ç¨‹ï¼Œé‚„æ˜¯æœƒæŠ½äº›æ™‚é–“å°‡ Ethereum å®˜æ–¹æ–‡ä»¶çš„ä¸€äº›åŸºæœ¬æ¦‚å¿µå†é‡æ–°çœ‹éã€‚

## Questions

## Feedback

> #### å¦‚æœæ˜¯ä¸åŒéˆï¼Œä¹Ÿ nonce ä¸€æ¨£ï¼Œé€™æ¨£æœƒä¸æœƒæœ‰ replay attack å‘¢ï¼Œå¦‚æœæœƒè©²å¦‚ä½•é¿å…ï¼Ÿ

å³ä½¿ nonce å’Œå…¶ä»–æ‰€æœ‰äº¤æ˜“åƒæ•¸éƒ½ä¸€æ¨£ï¼Œä¸åŒçš„ Chain ID æœƒç”¢ç”Ÿä¸åŒçš„ç°½åã€‚EIP-155 å¼•å…¥äº†ä½¿ç”¨ Chain ID çš„æ©Ÿåˆ¶ã€‚å³ä½¿ä½ åœ¨ä¸åŒçš„ä»¥å¤ªåŠéˆï¼ˆæ¯”å¦‚ä¸»ç¶²å’ŒæŸå€‹æ¸¬è©¦ç¶²ï¼‰æœ‰ç›¸åŒçš„å¸³æˆ¶å’Œç›¸åŒçš„ nonceï¼Œç”±æ–¼ Chain ID ä¸åŒï¼Œé€™å…©å€‹äº¤æ˜“æœƒæœ‰ä¸åŒçš„ç°½åã€‚å› æ­¤ï¼Œä¸€å€‹åœ¨æŸå€‹éˆä¸Šæœ‰æ•ˆçš„äº¤æ˜“ä¸æœƒè¢«é‡æ’­ï¼ˆreplayï¼‰åˆ°å¦ä¸€å€‹éˆä¸Šã€‚

> #### EIP-155

- EIP-155 ä¹‹å‰ï¼š(nonce, gasprice, startgas, to, value, data) é€²è¡Œ RLP ç·¨ç¢¼ï¼Œv æ˜¯ 27 æˆ– 28
- EIP-155 ä¹‹å¾Œï¼š (nonce, gasprice, startgas, to, value, data, chainid, 0, 0) é€²è¡Œ RLP ç·¨ç¢¼ï¼Œv = chain*id * 2 + 35 æˆ– v = chain*id * 2

åœ¨ EIP-155 å¯¦æ–½å¾Œï¼ŒChain ID ä¹Ÿæˆç‚ºäº†ç°½åéç¨‹çš„ä¸€éƒ¨åˆ†ã€‚å› æ­¤å³ä½¿å…©å€‹éˆåœ¨å…¶ä»–æ–¹é¢å®Œå…¨ç›¸åŒï¼Œåªè¦å®ƒå€‘æœ‰ä¸åŒçš„ Chain IDï¼Œç”¨ä¸€å€‹éˆä¸Šçš„ç°½ååœ¨å¦ä¸€å€‹éˆä¸Šå°±ä¸æœƒæœ‰æ•ˆã€‚

Source:

- https://github.com/ethereum/EIPs/blob/master/EIPS/eip-155.md
- https://ethereum.stackexchange.com/questions/69008/eip155-how-chainid-works
- https://chainid.network/
- https://www.cnblogs.com/wanghui-garcia/p/9648147.html
- https://foresightnews.pro/article/detail/38118
